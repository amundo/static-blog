---
title: Static Site Generator - Stage 1
date: 2025-02-17
description: Documentation of the initial version of our Deno-based static site generator
---


This is the initial version of our static site generator built with Deno. It provides basic functionality for converting markdown files with YAML frontmatter into HTML pages.

## Features

- Converts markdown files to HTML using marked
- Supports YAML frontmatter for metadata
- Basic responsive styling
- Simple directory structure

## Usage

### Directory Structure

```
your-project/
  ├── posts/            # Your markdown files go here
  │   └── post-1.md
  ├── blog/             # Generated HTML files appear here
  └── generator.js      # The static site generator script
```

### Markdown Format

Your markdown files should include YAML frontmatter at the top:

```markdown
---
title: Your Post Title
date: 2025-02-17
---

Your markdown content goes here...
```

### Running the Generator

```bash
deno run --allow-read --allow-write generator.js
```

## How It Works

The generator is built using modern JavaScript and Deno. Here's the complete code with explanations:

```js
import { join } from "@std/path";
import { ensureDir } from "@std/fs";
import { extract } from "@std/front_matter/any";
import { parse } from '@marked';

// Generate HTML page from template and content
function generatePage(content, metadata) {
  return `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${metadata.title}</title>
    <style>
      body {
        max-width: 800px;
        margin: 0 auto;
        padding: 1rem;
        font-family: system-ui, sans-serif;
        line-height: 1.5;
      }
      pre {
        padding: 1rem;
        background: #f6f8fa;
        border-radius: 4px;
        overflow-x: auto;
      }
    </style>
</head>
<body>
    <article>
        <h1>${metadata.title}</h1>
        <time>${new Date(metadata.date).toLocaleDateString()}</time>
        ${content}
    </article>
</body>
</html>
  `;
}

// Process a single markdown file
async function processFile(srcPath, destDir) {
  const fileName = srcPath.split('/').pop();
  const baseName = fileName?.split('.')[0];
  const destPath = join(destDir, `${baseName}.html`);

  try {
    const content = await Deno.readTextFile(srcPath);
    const { attrs: metadata, body } = extract(content);
    const html = parse(body);
    const pageHtml = generatePage(html, metadata);
    
    await Deno.writeTextFile(destPath, pageHtml);
    console.log(`Generated ${baseName}.html`);
  } catch (error) {
    console.error(`Error processing ${baseName}:`, error);
  }
}

// Main build function
async function build(postsDir = './posts', outputDir = './blog') {
  try {
    await ensureDir(outputDir);
    
    const files = [];
    for await (const entry of Deno.readDir(postsDir)) {
      if (entry.isFile && entry.name.endsWith('.md')) {
        files.push(entry.name);
      }
    }
    
    await Promise.all(
      files.map(file => 
        processFile(join(postsDir, file), outputDir)
      )
    );
  } catch (error) {
    console.error('Build failed:', error);
  }
}

// CLI
if (import.meta.main) {
  await build();
}
```

### Code Breakdown

1. **Imports**:
   - `@std/path`: For path manipulation
   - `@std/fs`: For file system operations
   - `@std/front_matter/any`: For parsing YAML frontmatter
   - `@marked`: For converting markdown to HTML (from npm)

2. **HTML Generation**:
   - The `generatePage` function creates a complete HTML page
   - Includes responsive styling with system fonts
   - Centers content with max-width for readability
   - Styles code blocks with a light gray background

3. **File Processing**:
   - `processFile` handles individual markdown files
   - Extracts frontmatter metadata
   - Converts markdown to HTML using marked
   - Writes the final HTML file

4. **Build Process**:
   - Creates the output directory if it doesn't exist
   - Finds all markdown files in the posts directory
   - Processes files concurrently using `Promise.all`

## Next Steps

Future enhancements planned:
- Index page generation
- File watching for development
- Tag support
- Syntax highlighting
- Cache invalidation for faster builds

## Requirements

- Deno 1.41 or later
- Write permissions for the output directory
- Read permissions for the posts directory
- npm package: marked